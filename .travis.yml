language: haskell

ghc: 
  - "8.0"
  - "8.2"

services:
  - mongodb

sudo: required

before_install: 
  - cabal install cabal-install
  - export PATH="$HOME/.cabal/bin:$PATH"
  - echo "Cabal updated, displaying new version..."
  - cabal -V
  - cabal install alex
  - cabal install happy
  - cabal install bnfc
  - npm install -g npm
  - sudo pip install virtualenv
  - virtualenv venv
  - source venv/bin/activate

script:
  - cabal configure --enable-tests && cabal build && cabal test
  - bash scripts/testing/end_to_end_tests.sh 0

